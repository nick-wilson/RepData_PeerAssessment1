---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

The following code was used to load and preprocess the data:

```{r dataload}
zipfile<-"activity.zip"
csvfile<-"activity.csv"
if (!file.exists(csvfile)) {
    unzip(zipfile)    
    }
activity_data<-read.csv(csvfile)
```

## What is mean total number of steps taken per day?

The following code was used to plot a histogram of the total
steps per day and then calculate the mean and median of that data:

```{r mean_steps_per_day,message=FALSE}
library(dplyr)
# add up the total steps on each date
activity_total_steps<-activity_data%>%group_by(date)%>%
    summarize(total_steps=sum(steps,na.rm=TRUE))
# plot a histogram of total steps
hist(activity_total_steps$total_steps,breaks=10,
     xlab="Total steps per day",main="Histogram of total steps per day")
# Calculate the mean
mean_steps_per_day<-mean(activity_total_steps$total_steps)
cat("The mean total number of steps per day is",mean_steps_per_day)
# Calculate the median
median_steps_per_day<-median(activity_total_steps$total_steps)
cat("The median total number of steps per day is",median_steps_per_day)
```

## What is the average daily activity pattern?

The following code calculates the average number of steps in each
interval, plots it and then identifies the interval with the
maximum value:

```{r dailypattern}
# group activity data by interval and calculate average
activity_mean_interval<-activity_data%>%group_by(interval)%>%
    summarize(mean_steps=mean(steps,na.rm=TRUE))
# plot as a line graph
plot(activity_mean_interval,type="l",ylab="Average steps",
     main="Number of steps averaged over all dates for each interval")
# identify index with maximum value
max_index<-order(activity_mean_interval$mean_steps,decreasing=TRUE)[1]
# identify interval corresponding to that index and print
max_interval<-as.numeric(activity_mean_interval[max_index,1])
cat("The interval with the maximum average number of steps is",max_interval)
```

## Imputing missing values

## Are there differences in activity patterns between weekdays and weekends?
